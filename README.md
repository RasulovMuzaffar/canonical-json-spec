# Canonical JSON Specification

Этот репозиторий содержит **референс-реализацию Canonical JSON** (далее `canonicalJson`) на нескольких языках:

- Java
- C#
- Python
- Go
- PHP

Цель `canonicalJson` — получить **детерминированное строковое представление JSON**, пригодное для:

- вычисления хэшей  
  `publisherHash = base64( SHA-256( canonicalJson(data) ) )`
- формирования данных для цифровой подписи  
  (`publisherSign`, `centerSign`)
- проверки целостности и авторства сообщений  
  (push-/pub-sub-платформы, государственные интеграции, B2B и др.)

> Все реализации следуют **одному и тому же алгоритму**, поэтому для одинакового входного JSON результат `canonicalJson` будет одинаковым на любом языке.

---

## Алгоритм `canonicalJson`

Для любого JSON-значения `V`:

1. **Объект (map / dictionary)**  
   Если `V` — объект (JSON object):

   - все поля объекта сортируются по ключу  
     **в лексикографическом порядке** (по алфавиту, `String`-сравнение);
   - для каждого значения рекурсивно применяется `canonicalJson`.

2. **Массив (array)**  
   Если `V` — массив:

   - порядок элементов **сохраняется** (не сортируется);
   - к каждому элементу рекурсивно применяется `canonicalJson`.

3. **Примитивы (primitive)**  
   Если `V` — примитив (`string`, `number`, `boolean`, `null`):

   - значение возвращается **без изменений**.

4. **Строковый вывод**

   - используется компактный JSON **без пробелов и переносов** (minified);
   - при наличии опций библиотек — **Unicode-символы не экранируются**,  
     чтобы `"тест"` не превращалось в `"\\u0442\\u0435\\u0441\\u0442"`.

---

## Пример

Вход (`examples/example1_input.json`):

```json
{
  "z": 1,
  "a": { "k": 2, "b": 1 },
  "list": [ { "x": 2, "a": 1 }, 3 ]
}
```

Результат (`examples/example1_canonical.json`):

```json
{"a":{"b":1,"k":2},"list":[{"a":1,"x":2},3],"z":1}
```
